//
// Settings according to CIS Mozilla Firefox 38 ESR Benchmark (v1.0.0 - 12-31-2015)

// Updating Firefox

// (L1) Enable Automatic Updates 
lockPref("app.update.enabled", true);
lockPref("app.update.auto", true);
lockPref("app.update.staging.enabled", true);

// (L1) Enable Auto-Notification of Outdated Plugins
lockPref("plugins.update.notifyUser", true);

// (L1) Enable Information Bar for Outdated Plugins
lockPref("plugins.hide_infobar_for_outdated_plugin", false);

// (L1) Set Update Interval Time Checks
lockPref("app.update.interval", 43200);

// (L1) Set Update Wait Time Prompt
lockPref("app.update.promptWaitTime", 172800);

// (L1) Ensure Update-related UI Components are Displayed
lockPref("app.update.silent", false);

// (L1) Set Search Provider Update Behavior
lockPref("browser.search.update", true);

// Network Settings

// (L2) Do Not Send Cross SSL/TLS Referrer Header
lockPref("network.http.sendSecureXSiteReferrer", false);

// (L1) Disable NTLM v1
lockPref("network.auth.force-generic-ntlm-v1", false);

// (L1) Enable Warning For "Phishy" URLs
lockPref("network.http.phishy-userpass-length", 1);

// (L2) Enable IDN Show Punycode 
lockPref("network.IDN_show_punycode", true);

// (L1) Set File URI Origin Policy
lockPref("security.fileuri.strict_origin_policy", true);

// (L1) Disable Cloud Sync
lockPref("services.sync.enabled", false);

// (L1) Disable WebRTC
lockPref("media.peerconnection.enabled", false);
lockPref("media.peerconnection.use_document_iceservers", false);

// Encryption Settings

// (L2) Set SSL Override Behavior
lockPref("browser.ssl_override_behavior", 0);

// (L1) Set Security TLS Version Maximum
// Changed value from TLSv1.2 to TLSv1.3
lockPref("security.tls.version.max", 4);

// (L1) Set Security TLS Version Minimum
// Changed value from TLSv1.0 to TLSv1.2
lockPref("security.tls.version.min", 3)

// (L2) Set OCSP Use Policy
lockPref("security.OCSP.enabled", 1);

// (L1) Block Mixed Active Content
lockPref("security.mixed_content.block_active_content", true);

//  (L2) Set OCSP Response Policy
lockPref("security.ocsp.require", true);

// JavaScript Settings

// (L1) Disallow JavaScripts Ability to Change the Status Bar Text
lockPref("dom.disable_window_status_change", true);

// (L1) Disable Scripting of Plugins by JavaScript
lockPref("security.xpconnect.plugin.unrestricted", false);

// (L1) Disallow JavaScripts Ability to Hide the Address Bar
lockPref("dom.disable_window_open_feature.location", true);

// (L1) Disallow JavaScripts Ability to Hide the Status Bar
lockPref("dom.disable_window_open_feature.status", true);

// (L1) Disable Closing of Windows via Scripts
lockPref("dom.allow_scripts_to_close_windows", false);

// (L1) Block Pop-up Windows
lockPref("privacy.popups.policy", 1);

// (L1) Disable Displaying JavaScript in History URLs
lockPref("browser.urlbar.filter.javascript", true);

// Privacy Settings

// (L1) Disallow Credential Storage
lockPref("signon.rememberSignons", false);

// (L1) Do Not Accept Third Party Cookies
lockPref("network.cookie.cookieBehavior", 1);

// (L1) Tracking Protection
lockPref("privacy.donottrackheader.enabled", true);
lockPref("privacy.donottrackheader.value", 1);
lockPref("privacy.trackingprotection.enabled ", true);
lockPref("privacy.trackingprotection.pbmode", true);

// (L1) Set Delay for Enabling Security Sensitive Dialog Boxes
lockPref("security.dialog_enable_delay", 2000);

// (L1) Disable Geolocation Serivces
lockPref("geo.enabled", false);

// Extensions and Add-ons

// (L1) Secure Application Plug-ins
lockPref("browser.helperApps.alwaysAsk.force", true);

// (L1) Disabling Auto-Install of Add-ons 
lockPref("xpinstall.whitelist.required", true);

// (L1) Enable Extension Block List
lockPref("extensions.blocklist.enabled", true);

// (L1) Set Extension Block List Interval
lockPref("extensions.blocklist.interval", 86400);

// (L1) Enable Warning for External Protocol Handler
lockPref("network.protocol-handler.warn-external-default", true);

//  (L1) Disable Popups Initiated by Plugins
lockPref("privacy.popups.disable_from_plugins", 2);

// (L1) Enable Extension Auto Update
lockPref("extensions.update.autoUpdateDefault", true);

// (L1) Enable Extension Update
lockPref("extensions.update.enabled", true);

// (L1) Set Extension Update Interval Time Checks
lockPref("extensions.update.interval", 86400);

// Malware Settings

// (L1) Enable Virus Scanning for Downloads
lockPref("browser.download.manager.scanWhenDone", true);

// (L1) Disable JAR from Opening Unsafe File Types
lockPref("network.jar.open-unsafe-types", false);

// (L1) Block Reported Web Forgeries
lockPref("browser.safebrowsing.enabled", true);

// (L1) Block Reported Attack Sites
lockPref("browser.safebrowsing.malware.enabled", true);